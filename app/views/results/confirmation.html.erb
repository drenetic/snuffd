<h2>Test Results for <%= @result.user.first_name %></h2>

<div class="table-responsive">
  <table class="table align-middle">
    <tbody>
      <tr>
        <th scope="row">Full Name</th>
        <td><%= @result.user.first_name %> <%= @result.user.last_name %></td>
      </tr>
      <tr>
        <th scope="row">Date of Birth</th>
        <td><%= @result.user.date_of_birth.strftime("%d %b %Y") %></td>
      </tr>
      <tr>
        <th scope="row">Gender</th>
        <td><%= @result.user.gender %></td>
      </tr>
      <tr>
        <th scope="row">Test Date</th>
        <td><%= @result.test_date.strftime("%d %b %Y") %></td>
      </tr>
      <tr>
        <th scope="row">Next Test Date</th>
        <td><%= @result.next_test_date.strftime("%d %b %Y") %></td>
      </tr>
    </tbody>
  </table>
</div>

<h3 class="mt-4">Infections</h3>
<div class="table-responsive">
  <table class="table align-middle">
    <thead>
    <tr>
      <th scope="col">Infection</th>
      <th scope="col">Status</th>
      <th scope="col">Treatment</th>
      <th scope="col">Expected Recovery Date</th>
    </tr>
    </thead>
    <tbody>
      <% @result.results_infections.each do |results_infection|  %>
        <tr>
          <th scope="row"><%= results_infection.infection.name.gsub("_", " ")  %></th>
          <td><%= results_infection.status.capitalize  %></td>
          <td>Is currently <%= results_infection.is_treated ? "" : "not" %> being treated.</td>
          <td><%= results_infection.end_date.strftime("%d %b %Y") %></td>
        </tr>
    <% end %>
    </tbody>
  </table>
</div>

<% if user_signed_in? && current_user.is_doctor %>
  <%= link_to "Confirm Result", result_path(@result), class: "btn btn-primary pink-button transition duration-300 ease-in-out transform hover:scale-105 pink-button pink-button:hover mrt-4" %>
  <%= link_to "Delete", result_path(@result), class: "btn btn-danger text-white transition duration-300 ease-in-out transform hover:scale-105 m-4" ,data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
<% end %>
